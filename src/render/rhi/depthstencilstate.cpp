/************************************************************************/
/*                                                                      */
/* INCLUDE                                                              */
/*                                                                      */
/************************************************************************/
#include "depthstencilstate.h"

#include "render/rhi/rhidevice.h"

/************************************************************************/
/*                                                                      */
/* DEFINES AND CONSTANTS                                                */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* MACROS                                                               */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* TYPES                                                                */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* STRUCTS                                                              */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* CLASSES                                                              */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* LOCAL VARIABLES                                                      */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* GLOBAL VARIABLES                                                     */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* LOCAL FUNCTIONS                                                      */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* EXTERNAL FUNCTIONS                                                   */
/*                                                                      */
/************************************************************************/
//------------------------------------------------------------------------
DepthStencilState::DepthStencilState( RHIDevice *owner, 
   depth_stencil_desc_t const &desc )
   : device(owner)
   , dx_state(nullptr)
{
   D3D11_DEPTH_STENCIL_DESC dxdesc;
   MemZero( &dxdesc );

   dxdesc.DepthEnable = desc.depth_writing_enabled || desc.depth_test_enabled;
   dxdesc.DepthWriteMask = desc.depth_writing_enabled ? D3D11_DEPTH_WRITE_MASK_ALL : D3D11_DEPTH_WRITE_MASK_ZERO;
   dxdesc.DepthFunc = desc.depth_test_enabled ? D3D11_COMPARISON_LESS : D3D11_COMPARISON_ALWAYS;
   dxdesc.StencilEnable = FALSE;
   
   HRESULT result = device->dx_device->CreateDepthStencilState( &dxdesc, &dx_state );
   UNREFERENCED(result); // ASSERT
}

//------------------------------------------------------------------------
DepthStencilState::~DepthStencilState()
{
   DX_SAFE_RELEASE(dx_state);
}


/************************************************************************/
/*                                                                      */
/* COMMANDS                                                             */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* UNIT TESTS                                                           */
/*                                                                      */
/************************************************************************/
