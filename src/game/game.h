#pragma once
#if !defined( __GAME__ )
#define __GAME__

/************************************************************************/
/*                                                                      */
/* INCLUDE                                                              */
/*                                                                      */
/************************************************************************/
#include "core/types.h"

#include "render/rhi/rhidevice.h"
#include "render/rhi/rhidevicecontext.h"
#include "render/rhi/rhioutput.h"
#include "game/game_config.h"
#include "game/simplerenderer.h"

#include "render/rhi/sampler.h"
#include "render/rhi/texture2d.h"

/************************************************************************/
/*                                                                      */
/* DEFINES AND CONSTANTS                                                */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* MACROS                                                               */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* TYPES                                                                */
/*                                                                      */
/************************************************************************/
enum eQuitReason 
{
   QUITREASON_NONE,
   QUITREASON_USER,
};

class Game;
class GameState;

/************************************************************************/
/*                                                                      */
/* STRUCTS                                                              */
/*                                                                      */
/************************************************************************/

/************************************************************************/
/*                                                                      */
/* CLASSES                                                              */
/*                                                                      */
/************************************************************************/

//------------------------------------------------------------------------
//------------------------------------------------------------------------
class Game
{
   public:
      //------------------------------------------------------------------------
      Game();
      ~Game();

      //------------------------------------------------------------------------
      void run();

      //------------------------------------------------------------------------
      void start();
      void run_frame();
      void end();

      //------------------------------------------------------------------------
      void update_sim();
      void render();

      //------------------------------------------------------------------------
      void quit( eQuitReason reason = QUITREASON_USER );

      //------------------------------------------------------------------------
      inline bool is_quitting() const { return quit_reason != QUITREASON_NONE; }
      inline bool is_running() const { return !is_quitting(); }

   public:
      //------------------------------------------------------------------------
      static Game* GetInstance() { return sInstance; }


      
   public:
      //------------------------------------------------------------------------
      void init_rendering();
      void cleanup_rendering();

      //------------------------------------------------------------------------
      SimpleRenderer renderer;
      ShaderProgram *my_shader;
      VertexBuffer *tri_vbo;

      Texture2D *tex_sample;
      Sampler *point_sampler;

      eQuitReason quit_reason;
      GameState *current_state;

      //------------------------------------------------------------------------
      static Game *sInstance;


};


/************************************************************************/
/*                                                                      */
/* GLOBAL VARIABLES                                                     */
/*                                                                      */
/************************************************************************/


/************************************************************************/
/*                                                                      */
/* FUNCTION PROTOTYPES                                                  */
/*                                                                      */
/************************************************************************/
#endif 
